<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>Messenger - Qeydiyyat vÉ™ Ã‡at</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #e4e7ec;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 370px;
            margin: 40px auto 0 auto;
            background: #fff;
            padding: 28px 35px 20px 35px;
            box-shadow: 0 0 12px #bbb;
            border-radius: 9px;
        }
        h2 {
            text-align: center;
            color: #284e8f;
        }
        .input-group {
            margin: 13px 0;
        }
        .input-group label {
            font-size: 15px;
            color: #555;
        }
        .input-group input {
            width: 100%;
            padding: 10px;
            margin-top: 6px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .register-btn, .chat-btn {
            width: 100%;
            padding: 12px;
            background: #1976d2;
            color: #fff;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .register-btn:hover, .chat-btn:hover {
            background: #135ba1;
        }
        .login-link {
            margin-top: 17px;
            text-align: center;
            display: block;
            color: #1976d2;
            text-decoration: none;
        }
        .error {
            color: #d32f2f;
            text-align: center;
            margin-bottom: 10px;
        }
        .success {
            color: #388e3c;
            text-align: center;
            margin-bottom: 10px;
        }
        /* Ã‡at stili */
        .chat-container {
            display: none;
            flex-direction: column;
            height: 420px;
            border-radius: 8px;
        }
        .chat-header {
            background: #1976d2;
            color: #fff;
            padding: 12px;
            border-radius: 8px 8px 0 0;
            font-size: 18px;
            text-align: center;
        }
        .chat-messages {
            flex: 1;
            padding: 15px;
            background: #f5f5f5;
            overflow-y: auto;
            min-height: 240px;
            max-height: 240px;
            border-bottom: 1px solid #ddd;
        }
        .chat-input-group {
            display: flex;
            padding: 8px 0 0 0;
        }
        .chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #b6b6b6;
            border-radius: 5px 0 0 5px;
        }
        .chat-btn {
            border-radius: 0 5px 5px 0;
            width: 90px;
        }
        .msg-me {
            background: #c7e2ff;
            padding: 8px 13px;
            border-radius: 8px 8px 2px 8px;
            margin-bottom: 8px;
            max-width: 70%;
            align-self: flex-end;
            margin-left: 30%;
            font-size: 15px;
        }
        .msg-them {
            background: #f0f1f5;
            padding: 8px 13px;
            border-radius: 8px 8px 8px 2px;
            margin-bottom: 8px;
            max-width: 70%;
            align-self: flex-start;
            font-size: 15px;
        }
        .select-user {
            margin-bottom: 12px;
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        @media (max-width: 500px) {
            .container { width: 98%; padding: 10px; }
            .chat-header { font-size: 16px; }
        }
    </style>
    <script>
        // Demo Ã¼Ã§Ã¼n sadÉ™ istifadÉ™Ã§i siyahÄ±sÄ±
        const users = [
            {name: "Nicat", email: "nicat@gmail.com"},
            {name: "Aysel", email: "aysel@gmail.com"},
            {name: "Rasim", email: "rasim@gmail.com"}
        ];

        let currentUser = null;
        let selectedUser = null;

        function showChatUI() {
            document.getElementById('register-form').style.display = "none";
            document.querySelector('.chat-container').style.display = "flex";
            document.getElementById('chat-header-user').textContent = currentUser.name;
            // DigÉ™r istifadÉ™Ã§ilÉ™ri seÃ§mÉ™k Ã¼Ã§Ã¼n siyahÄ± hazÄ±rla
            const select = document.getElementById('user-select');
            select.innerHTML = "";
            users.filter(u => u.email !== currentUser.email).forEach(user => {
                const opt = document.createElement("option");
                opt.value = user.email;
                opt.textContent = `${user.name} (${user.email})`;
                select.appendChild(opt);
            });
            if(select.options.length) {
                selectedUser = users.find(u => u.email === select.options[0].value);
            }
        }

        function validateForm(event) {
            event.preventDefault();
            var gmailInput = document.getElementById('gmail').value.trim();
            var passwordInput = document.getElementById('password').value.trim();
            var errorDiv = document.getElementById('error');
            var successDiv = document.getElementById('success');
            errorDiv.innerHTML = "";
            successDiv.innerHTML = "";
            var gmailPattern = /^[a-zA-Z0-9_.+-]+@gmail\.com$/;
            if (!gmailPattern.test(gmailInput)) {
                errorDiv.innerHTML = "ZÉ™hmÉ™t olmasa dÃ¼zgÃ¼n Gmail Ã¼nvanÄ± daxil edin!";
                return false;
            }
            if (passwordInput.length < 6) {
                errorDiv.innerHTML = "ÅžifrÉ™ É™n azÄ± 6 simvoldan ibarÉ™t olmalÄ±dÄ±r!";
                return false;
            }
            // Demo Ã¼Ã§Ã¼n qeydiyyat vÉ™ ya "daxil ol"
            let user = users.find(u => u.email === gmailInput);
            if (!user) {
                user = {name: gmailInput.split('@')[0], email: gmailInput};
                users.push(user);
            }
            currentUser = user;
            successDiv.innerHTML = "Qeydiyyat uÄŸurla tamamlandÄ±, sisteme daxil olursunuz...";
            setTimeout(showChatUI, 900);
            return false;
        }

        function onUserChange(e) {
            selectedUser = users.find(u => u.email === e.target.value);
            document.getElementById('chat-messages').innerHTML = "";
        }

        function sendMessage(event) {
            event.preventDefault();
            const input = document.getElementById('chat-input');
            const msg = input.value.trim();
            if (!msg) return;
            const messagesDiv = document.getElementById('chat-messages');
            const myMsgDiv = document.createElement("div");
            myMsgDiv.className = "msg-me";
            myMsgDiv.textContent = msg;
            messagesDiv.appendChild(myMsgDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            input.value = "";
            // Demo Ã¼Ã§Ã¼n cavab (real backend Ã¼Ã§Ã¼n burada mesaj gÃ¶ndÉ™rmÉ™k vÉ™ qÉ™bul etmÉ™k lazÄ±mdÄ±r)
            setTimeout(function() {
                const replyDiv = document.createElement("div");
                replyDiv.className = "msg-them";
                replyDiv.textContent = selectedUser ? selectedUser.name + ": Salam! ðŸ‘‹" : "Salam! ðŸ‘‹";
                messagesDiv.appendChild(replyDiv);
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }, 800);
        }
    </script>
</head>
<body>
    <div class="container">
        <!-- Qeydiyyat formu -->
        <form id="register-form" onsubmit="validateForm(event)">
            <h2>Messenger Qeydiyyat</h2>
            <div class="input-group">
                <label for="gmail">Gmail Ã¼nvanÄ±:</label>
                <input type="email" id="gmail" name="gmail" placeholder="nÃ¼munÉ™@gmail.com" required>
            </div>
            <div class="input-group">
                <label for="password">ÅžifrÉ™:</label>
                <input type="password" id="password" name="password" placeholder="ÅžifrÉ™nizi daxil edin" required>
            </div>
            <div id="error" class="error"></div>
            <div id="success" class="success"></div>
            <button type="submit" class="register-btn">Qeydiyyatdan keÃ§ / Daxil ol</button>
        </form>

        <!-- Ã‡at interfeysi -->
        <div class="chat-container" style="display:none; flex-direction: column;">
            <div class="chat-header">
                <span id="chat-header-user"></span> kimi daxil olmusunuz
            </div>
            <select class="select-user" id="user-select" onchange="onUserChange(event)">
            </select>
            <div id="chat-messages" class="chat-messages"></div>
            <form class="chat-input-group" onsubmit="sendMessage(event)">
                <input type="text" class="chat-input" id="chat-input" placeholder="Mesaj yazÄ±n...">
                <button class="chat-btn" type="submit">GÃ¶ndÉ™r</button>
            </form>
        </div>
        <a href="#" class="login-link" onclick="location.reload()">Ã‡Ä±xÄ±ÅŸ</a>
    </div>
</body>
</html>
  <script>
    // Firebase konfiqurasiya
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Firebase baÅŸladÄ±lÄ±r
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const provider = new firebase.auth.GoogleAuthProvider();

    const loginPanel = document.getElementById("loginPanel");
    const chatPanel = document.getElementById("chatPanel");
    const googleLoginBtn = document.getElementById("googleLogin");
    const logoutBtn = document.getElementById("logoutBtn");
    const messagesDiv = document.getElementById("messages");
    const messageInput = document.getElementById("messageInput");
    const sendBtn = document.getElementById("sendBtn");

    let currentUser = null;

    // Gmail login redirect metodu
    googleLoginBtn.addEventListener("click", () => {
      auth.signInWithRedirect(provider);
    });

    // Google-dan qayÄ±dandan sonra istifadÉ™Ã§i mÉ™lumatÄ±
    auth.getRedirectResult().then((result) => {
      if (result.user) {
        currentUser = result.user;
        showChatPanel();
      }
    }).catch(error => {
      console.error("Login xÉ™tasÄ±:", error.message);
    });

    // Auth vÉ™ziyyÉ™tini izlÉ™yirik
    auth.onAuthStateChanged(user => {
      if (user) {
        currentUser = user;
        showChatPanel();
      } else {
        showLoginPanel();
      }
    });

    function showChatPanel() {
      loginPanel.classList.add("hidden");
      chatPanel.classList.remove("hidden");
      loadMessages();
    }

    function showLoginPanel() {
      chatPanel.classList.add("hidden");
      loginPanel.classList.remove("hidden");
    }

    // Ã‡Ä±xÄ±ÅŸ
    logoutBtn.addEventListener("click", async () => {
      await auth.signOut();
    });

    // MesajlarÄ± oxumaq
    function loadMessages() {
      db.collection("messages")
        .orderBy("timestamp")
        .onSnapshot(snapshot => {
          messagesDiv.innerHTML = "";
          snapshot.forEach(doc => {
            const msg = doc.data();
            const div = document.createElement("div");
            div.classList.add(
              "p-2", "my-1", "rounded-xl",
              msg.email === currentUser.email ? "bg-blue-200 text-right" : "bg-gray-200"
            );
            div.innerText = `${msg.name}: ${msg.text}`;
            messagesDiv.appendChild(div);
          });
          messagesDiv.scrollTop = messagesDiv.scrollHeight;
        });
    }

    // Mesaj gÃ¶ndÉ™rmÉ™k
    sendBtn.addEventListener("click", async () => {
      if (messageInput.value.trim() !== "" && currentUser) {
        await db.collection("messages").add({
          name: currentUser.displayName,
          email: currentUser.email,
          text: messageInput.value,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        messageInput.value = "";
      }
    });
  </script>
</body>
</html>
  <script>
    // Firebase konfiqurasiya
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Firebase baÅŸladÄ±lÄ±r
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const provider = new firebase.auth.GoogleAuthProvider();

    const loginPanel = document.getElementById("loginPanel");
    const chatPanel = document.getElementById("chatPanel");
    const googleLoginBtn = document.getElementById("googleLogin");
    const logoutBtn = document.getElementById("logoutBtn");
    const messagesDiv = document.getElementById("messages");
    const messageInput = document.getElementById("messageInput");
    const sendBtn = document.getElementById("sendBtn");

    let currentUser = null;

    // Ä°stifadÉ™Ã§i statusunu izlÉ™yirik
    auth.onAuthStateChanged(user => {
      if (user) {
        currentUser = user;
        loginPanel.classList.add("hidden");
        chatPanel.classList.remove("hidden");
        loadMessages();
      } else {
        currentUser = null;
        chatPanel.classList.add("hidden");
        loginPanel.classList.remove("hidden");
      }
    });

    // Gmail ilÉ™ login
    googleLoginBtn.addEventListener("click", async () => {
      try {
        await auth.signInWithPopup(provider);
      } catch (error) {
        alert("XÉ™ta baÅŸ verdi: " + error.message);
      }
    });

    // Ã‡Ä±xÄ±ÅŸ
    logoutBtn.addEventListener("click", async () => {
      await auth.signOut();
    });

    // MesajlarÄ± yÃ¼klÉ™mÉ™k
    function loadMessages() {
      db.collection("messages")
        .orderBy("timestamp")
        .onSnapshot(snapshot => {
          messagesDiv.innerHTML = "";
          snapshot.forEach(doc => {
            const msg = doc.data();
            const div = document.createElement("div");
            div.classList.add(
              "p-2", "my-1", "rounded-xl",
              msg.email === currentUser.email ? "bg-blue-200 text-right" : "bg-gray-200"
            );
            div.innerText = `${msg.name}: ${msg.text}`;
            messagesDiv.appendChild(div);
          });
          messagesDiv.scrollTop = messagesDiv.scrollHeight;
        });
    }

    // Mesaj gÃ¶ndÉ™rmÉ™k
    sendBtn.addEventListener("click", async () => {
      if (messageInput.value.trim() !== "" && currentUser) {
        await db.collection("messages").add({
          name: currentUser.displayName,
          email: currentUser.email,
          text: messageInput.value,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        messageInput.value = "";
      }
    });
  </script>
</body>
  </html>
